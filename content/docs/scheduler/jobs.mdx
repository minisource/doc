---
title: Job Management
description: Creating and managing scheduled jobs
---

# Job Management

Jobs are the core entities in the Scheduler service. Each job defines what to execute, when to execute it, and how to handle failures.

## Job Structure

```typescript
interface Job {
  id: string;           // UUID
  tenant_id: string;    // Tenant UUID
  name: string;         // Job name
  description?: string; // Optional description
  type: 'cron' | 'one_time' | 'interval';
  status: 'active' | 'paused' | 'disabled' | 'deleted';
  schedule: string;     // Cron expression, timestamp, or interval
  timezone?: string;    // Timezone (default: UTC)
  endpoint: string;     // HTTP endpoint to call
  method: string;       // HTTP method (default: POST)
  headers?: object;     // Custom HTTP headers
  payload?: object;     // Request body
  timeout: number;      // Timeout in seconds
  max_retries: number;  // Max retry attempts
  priority: number;     // Priority (1-10)
  tags?: string[];      // Tags for filtering
  next_run_at?: string; // Next scheduled execution
  last_run_at?: string; // Last execution time
  run_count: number;    // Total executions
  fail_count: number;   // Failed executions
}
```

## Creating Jobs

### Cron Job

Execute on a schedule using cron expressions (with seconds):

```bash
curl -X POST http://localhost:5003/api/v1/jobs \
  -H "Content-Type: application/json" \
  -H "X-Tenant-ID: tenant-uuid" \
  -d '{
    "name": "Daily Database Backup",
    "type": "cron",
    "schedule": "0 0 2 * * *",
    "endpoint": "http://backup-service:8080/api/backup",
    "method": "POST",
    "timeout": 300,
    "max_retries": 3,
    "priority": 10
  }'
```

**Cron Expression Format** (6 fields):
```
┌───────────── second (0-59)
│ ┌───────────── minute (0-59)
│ │ ┌───────────── hour (0-23)
│ │ │ ┌───────────── day of month (1-31)
│ │ │ │ ┌───────────── month (1-12)
│ │ │ │ │ ┌───────────── day of week (0-6, 0=Sunday)
│ │ │ │ │ │
* * * * * *
```

**Common Patterns**:
- `0 0 * * * *` - Every hour
- `0 0 9 * * *` - Every day at 9:00 AM
- `0 */5 * * * *` - Every 5 minutes
- `0 0 0 * * 0` - Every Sunday at midnight

### One-Time Job

Execute once at a specific time:

```bash
curl -X POST http://localhost:5003/api/v1/jobs \
  -H "Content-Type: application/json" \
  -H "X-Tenant-ID: tenant-uuid" \
  -d '{
    "name": "Send Promotional Email",
    "type": "one_time",
    "schedule": "2024-12-25T10:00:00Z",
    "endpoint": "http://notifier:5001/api/v1/email/send",
    "method": "POST",
    "payload": {
      "template": "holiday_promotion",
      "audience": "all_subscribers"
    }
  }'
```

### Interval Job

Execute at fixed intervals:

```bash
curl -X POST http://localhost:5003/api/v1/jobs \
  -H "Content-Type: application/json" \
  -H "X-Tenant-ID: tenant-uuid" \
  -d '{
    "name": "Health Check",
    "type": "interval",
    "schedule": "60",
    "endpoint": "http://auth:5000/health",
    "method": "GET",
    "timeout": 10
  }'
```

## Listing Jobs

```bash
# List all jobs
curl http://localhost:5003/api/v1/jobs \
  -H "X-Tenant-ID: tenant-uuid"

# Filter by status
curl "http://localhost:5003/api/v1/jobs?status=active" \
  -H "X-Tenant-ID: tenant-uuid"

# Filter by type
curl "http://localhost:5003/api/v1/jobs?type=cron" \
  -H "X-Tenant-ID: tenant-uuid"

# Search by name
curl "http://localhost:5003/api/v1/jobs?name=backup" \
  -H "X-Tenant-ID: tenant-uuid"

# Paginate results
curl "http://localhost:5003/api/v1/jobs?page=1&page_size=20" \
  -H "X-Tenant-ID: tenant-uuid"
```

## Updating Jobs

```bash
curl -X PUT http://localhost:5003/api/v1/jobs/{job_id} \
  -H "Content-Type: application/json" \
  -H "X-Tenant-ID: tenant-uuid" \
  -d '{
    "schedule": "0 0 3 * * *",
    "timeout": 600
  }'
```

## Job Operations

### Pause Job

```bash
curl -X POST http://localhost:5003/api/v1/jobs/{job_id}/pause \
  -H "X-Tenant-ID: tenant-uuid"
```

### Resume Job

```bash
curl -X POST http://localhost:5003/api/v1/jobs/{job_id}/resume \
  -H "X-Tenant-ID: tenant-uuid"
```

### Trigger Job Manually

```bash
curl -X POST http://localhost:5003/api/v1/jobs/{job_id}/trigger \
  -H "X-Tenant-ID: tenant-uuid"
```

### Delete Job

```bash
curl -X DELETE http://localhost:5003/api/v1/jobs/{job_id} \
  -H "X-Tenant-ID: tenant-uuid"
```

## Job Statistics

```bash
curl http://localhost:5003/api/v1/jobs/stats \
  -H "X-Tenant-ID: tenant-uuid"
```

Response:
```json
{
  "success": true,
  "data": {
    "total_jobs": 25,
    "active_jobs": 20,
    "paused_jobs": 5,
    "jobs_by_type": {
      "cron": 15,
      "interval": 8,
      "one_time": 2
    },
    "jobs_by_status": {
      "active": 20,
      "paused": 5
    }
  }
}
```

## HTTP Headers Sent by Scheduler

When executing a job, the scheduler sends these headers:

| Header | Description |
|--------|-------------|
| `User-Agent` | `Minisource-Scheduler/1.0` |
| `X-Scheduler-Job-ID` | The job's UUID |
| `X-Scheduler-Tenant-ID` | The tenant's UUID |
| `Content-Type` | `application/json` (if payload exists) |

Plus any custom headers defined in the job's `headers` field.

## Priority Levels

Jobs with higher priority are executed first when multiple jobs are due:

| Priority | Level | Use Case |
|----------|-------|----------|
| 10 | Critical | System maintenance, backups |
| 7-9 | High | Important business processes |
| 4-6 | Medium | Regular tasks |
| 1-3 | Low | Non-urgent background work |
